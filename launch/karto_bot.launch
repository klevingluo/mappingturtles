<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<launch>

  <rosparam file="$(find mappingturtles)/param/ros.yaml" />

  <arg name="base" default="$(optenv TURTLEBOT_BASE kobuki)" />
  <arg name="stacks" default="$(optenv TURTLEBOT_STACKS hexagons)" />
  <arg name="3d_sensor" default="$(optenv TURTLEBOT_3D_SENSOR astra)" />
  <!-- Real Turtlebot -->
  <include file="$(find turtlebot_bringup)/launch/minimal.launch">
    <arg name="base" value="$(arg base)" />
    <arg name="stacks" value="$(arg stacks)" />
    <arg name="3d_sensor" value="$(arg 3d_sensor)" />
  </include>

  <include file="$(find turtlebot_bringup)/launch/3dsensor.launch">
    <arg name="rgb_processing" value="false" />
    <arg name="depth_registration" value="false" />
    <arg name="depth_processing" value="false" />
    <arg name="scan_topic" value="/scan" />
  </include>

  <!-- Start Mapper to generate map from laser scans -->
  <node name="Mapper" pkg="nav2d_karto" type="mapper">
    <remap from="map" to="karto_map" />
    <remap from="base_scan" to ="scan" />
    <remap from="base_laser_link" to="camera_link" />
    <rosparam file="$(find nav2d_tutorials)/param/mapper.yaml" />
  </node>
  
  <node name="GetMap" pkg="nav2d_navigator" type="get_map_client" />

  <!-- Move base --> 
  <include file="$(find turtlebot_navigation)/launch/includes/move_base.launch.xml" />
</launch>
